{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ndx-try.gov.uk/schemas/scenario.schema.json",
  "title": "NDX:Try Scenario",
  "description": "Schema for AWS scenario metadata in NDX:Try portal",
  "type": "object",
  "required": ["scenarios"],
  "properties": {
    "scenarios": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "id",
          "name",
          "headline",
          "bestFor",
          "description",
          "difficulty",
          "timeEstimate",
          "primaryPersona",
          "awsServices",
          "securitySummary",
          "skillsLearned"
        ],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-z0-9-]+$",
            "description": "URL-safe unique identifier for the scenario"
          },
          "name": {
            "type": "string",
            "minLength": 3,
            "maxLength": 100,
            "description": "Display name for the scenario"
          },
          "headline": {
            "type": "string",
            "minLength": 10,
            "maxLength": 150,
            "description": "Brief headline describing the scenario's value"
          },
          "bestFor": {
            "type": "string",
            "minLength": 10,
            "maxLength": 100,
            "description": "One-line use case summary (e.g., 'Best for: reducing call volume')"
          },
          "description": {
            "type": "string",
            "minLength": 50,
            "maxLength": 500,
            "description": "Full description of what the scenario demonstrates"
          },
          "difficulty": {
            "type": "string",
            "enum": ["beginner", "intermediate", "advanced"],
            "description": "Technical difficulty level"
          },
          "timeEstimate": {
            "type": "string",
            "pattern": "^\\d+-?\\d*\\s*(minutes?|hours?|mins?)$",
            "description": "Estimated time to complete (e.g., '15 minutes', '1-2 hours')"
          },
          "primaryPersona": {
            "type": "string",
            "enum": ["technical", "service-manager", "finance", "leadership"],
            "description": "Primary target audience for this scenario"
          },
          "secondaryPersonas": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["technical", "service-manager", "finance", "leadership"]
            },
            "description": "Additional target audiences"
          },
          "relatedScenarios": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[a-z0-9-]+$"
            },
            "description": "IDs of related scenarios for cross-linking"
          },
          "estimatedCost": {
            "type": "string",
            "description": "Estimated AWS cost for running the scenario"
          },
          "maximumCost": {
            "type": "string",
            "description": "Maximum possible cost cap for the scenario"
          },
          "securitySummary": {
            "type": "string",
            "minLength": 10,
            "maxLength": 200,
            "description": "One-line security posture summary (e.g., 'Innovation Sandbox isolated')"
          },
          "skillsLearned": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            },
            "description": "Skills and technologies user will learn from this scenario"
          },
          "isMostPopular": {
            "type": "boolean",
            "default": false,
            "description": "Whether this scenario has the Most Popular badge"
          },
          "awsServices": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "string"
            },
            "description": "List of AWS services used in this scenario"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Categorization tags for filtering"
          },
          "businessOutcomes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Business outcomes this scenario can help achieve"
          },
          "prerequisites": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Requirements before starting the scenario"
          },
          "url": {
            "type": "string",
            "format": "uri-reference",
            "description": "URL path to the scenario detail page"
          },
          "deployment": {
            "type": "object",
            "description": "CloudFormation deployment configuration (AC-2.1.1, AC-2.1.2)",
            "required": ["templateUrl", "region"],
            "properties": {
              "templateUrl": {
                "type": "string",
                "format": "uri",
                "description": "CloudFormation template URL (HTTPS)"
              },
              "templateS3Url": {
                "type": "string",
                "format": "uri",
                "description": "S3 URL for template (s3:// format)"
              },
              "region": {
                "type": "string",
                "pattern": "^[a-z]{2}-[a-z]+-\\d$",
                "default": "eu-west-2",
                "description": "AWS region for deployment (default: eu-west-2 London)"
              },
              "stackNamePrefix": {
                "type": "string",
                "pattern": "^[a-zA-Z][a-zA-Z0-9-]*$",
                "maxLength": 114,
                "description": "Prefix for CloudFormation stack name (max 114 chars to allow timestamp suffix)"
              },
              "parameters": {
                "type": "array",
                "description": "Pre-filled CloudFormation parameters (AC-2.1.2)",
                "items": {
                  "type": "object",
                  "required": ["name", "value"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "CloudFormation parameter name"
                    },
                    "value": {
                      "type": "string",
                      "description": "Parameter value"
                    },
                    "description": {
                      "type": "string",
                      "description": "User-friendly description of this parameter"
                    }
                  }
                }
              },
              "costBreakdown": {
                "type": "object",
                "description": "Detailed cost breakdown for transparency (AC-2.1.6)",
                "properties": {
                  "services": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": ["name", "cost"],
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "AWS service name"
                        },
                        "cost": {
                          "type": "string",
                          "description": "Estimated cost for this service"
                        },
                        "note": {
                          "type": "string",
                          "description": "Additional cost notes"
                        }
                      }
                    }
                  },
                  "autoCleanup": {
                    "type": "string",
                    "description": "Auto-cleanup timing information"
                  },
                  "costCalculatorUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "Link to AWS Cost Calculator for this scenario"
                  }
                }
              },
              "tags": {
                "type": "array",
                "description": "CloudFormation resource tags",
                "items": {
                  "type": "object",
                  "required": ["key", "value"],
                  "properties": {
                    "key": {
                      "type": "string",
                      "description": "Tag key"
                    },
                    "value": {
                      "type": "string",
                      "description": "Tag value"
                    }
                  }
                }
              },
              "capabilities": {
                "type": "array",
                "description": "Required CloudFormation capabilities",
                "items": {
                  "type": "string",
                  "enum": ["CAPABILITY_IAM", "CAPABILITY_NAMED_IAM", "CAPABILITY_AUTO_EXPAND"]
                }
              },
              "deploymentTime": {
                "type": "string",
                "pattern": "^\\d+-?\\d*\\s*(minutes?|mins?)$",
                "description": "Estimated deployment time (e.g., '3-5 minutes')"
              },
              "deploymentPhases": {
                "type": "array",
                "description": "Array of deployment phases describing what happens during deployment",
                "items": {
                  "type": "string"
                }
              },
              "outputs": {
                "type": "array",
                "description": "Expected CloudFormation outputs after deployment",
                "items": {
                  "type": "object",
                  "required": ["name", "description"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "Output key name in CloudFormation"
                    },
                    "description": {
                      "type": "string",
                      "description": "User-friendly description of the output"
                    }
                  }
                }
              }
            }
          },
          "templateUrl": {
            "type": "string",
            "format": "uri",
            "description": "CloudFormation template URL (deprecated, use deployment.templateUrl)"
          },
          "demoVideoUrl": {
            "type": "string",
            "format": "uri",
            "description": "URL to demonstration video (deprecated, use video object)"
          },
          "video": {
            "type": "object",
            "description": "Demo video metadata for zero-deployment path (Story 2.4)",
            "properties": {
              "youtubeId": {
                "type": "string",
                "pattern": "^[a-zA-Z0-9_-]{11}$",
                "description": "YouTube video ID (11 characters)"
              },
              "title": {
                "type": "string",
                "minLength": 5,
                "maxLength": 150,
                "description": "Video title for accessibility"
              },
              "duration": {
                "type": "string",
                "pattern": "^\\d{1,2}:\\d{2}(:\\d{2})?$",
                "description": "Video duration in M:SS or MM:SS format"
              },
              "recordedDate": {
                "type": "string",
                "format": "date",
                "description": "Date video was recorded (YYYY-MM-DD)"
              },
              "transcript": {
                "type": "string",
                "description": "Full transcript text (HTML allowed)"
              },
              "transcriptPath": {
                "type": "string",
                "description": "Path to external transcript file"
              }
            }
          },
          "screenshots": {
            "type": "object",
            "description": "Screenshot walkthrough metadata for zero-deployment path (Story 2.5)",
            "properties": {
              "steps": {
                "type": "array",
                "description": "Array of screenshot steps with annotations (AC-2.5.2, AC-2.5.6)",
                "minItems": 0,
                "maxItems": 10,
                "items": {
                  "type": "object",
                  "required": ["stepNumber", "alt", "annotation"],
                  "properties": {
                    "stepNumber": {
                      "type": "integer",
                      "minimum": 1,
                      "description": "Step number for display (1-based)"
                    },
                    "image": {
                      "type": "string",
                      "description": "Path to screenshot image (e.g., /assets/screenshots/council-chatbot/step-1.png)"
                    },
                    "alt": {
                      "type": "string",
                      "minLength": 10,
                      "maxLength": 200,
                      "description": "Descriptive alt text for accessibility (AC-2.5.7)"
                    },
                    "annotation": {
                      "type": "string",
                      "minLength": 10,
                      "maxLength": 300,
                      "description": "Annotation text explaining what this screenshot shows (AC-2.5.3)"
                    }
                  }
                }
              }
            }
          },
          "order": {
            "type": "integer",
            "minimum": 1,
            "description": "Display order in listings"
          },
          "featured": {
            "type": "boolean",
            "description": "Whether to feature this scenario prominently"
          },
          "status": {
            "type": "string",
            "enum": ["draft", "active", "deprecated"],
            "default": "active",
            "description": "Publication status"
          },
          "gcloud_search_term": {
            "type": "string",
            "minLength": 5,
            "maxLength": 200,
            "description": "G-Cloud Digital Marketplace search term for finding suppliers (Story 5-1)"
          },
          "success_metrics": {
            "type": "object",
            "description": "Service-specific success metrics and ROI guidance (Story 4-4)",
            "required": ["service_area", "primary_metric", "baseline", "projection", "roi", "committee_language"],
            "properties": {
              "service_area": {
                "type": "string",
                "description": "Service area this scenario impacts (e.g., Contact Center, Planning Department)"
              },
              "primary_metric": {
                "type": "string",
                "description": "Primary success metric being measured"
              },
              "baseline": {
                "type": "object",
                "required": ["description", "value", "unit", "source"],
                "properties": {
                  "description": {
                    "type": "string",
                    "description": "Description of current baseline state"
                  },
                  "value": {
                    "type": "number",
                    "description": "Numeric baseline value"
                  },
                  "unit": {
                    "type": "string",
                    "description": "Unit of measurement for baseline"
                  },
                  "source": {
                    "type": "string",
                    "description": "Source citation for baseline data (e.g., LGA report)"
                  }
                }
              },
              "projection": {
                "type": "object",
                "required": ["description", "value", "reduction_percent"],
                "properties": {
                  "description": {
                    "type": "string",
                    "description": "Description of projected state with AI solution"
                  },
                  "value": {
                    "type": "number",
                    "description": "Projected value with AI solution"
                  },
                  "reduction_percent": {
                    "type": "number",
                    "description": "Percentage improvement achieved"
                  }
                }
              },
              "roi": {
                "type": "object",
                "required": ["annual_savings", "calculation", "payback_months", "disclaimer"],
                "properties": {
                  "annual_savings": {
                    "type": "number",
                    "description": "Projected annual savings in GBP"
                  },
                  "calculation": {
                    "type": "string",
                    "description": "Formula showing how savings were calculated"
                  },
                  "payback_months": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Months until investment pays back"
                  },
                  "disclaimer": {
                    "type": "string",
                    "description": "Required disclaimer about illustrative nature of projection"
                  }
                }
              },
              "committee_language": {
                "type": "string",
                "description": "Committee-ready summary language for presentations"
              }
            }
          },
          "security_posture": {
            "type": "object",
            "description": "Security posture data for CTO Evidence Pack (Story 4-4)",
            "required": ["certifications", "data_residency", "encryption", "data_handling"],
            "properties": {
              "certifications": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "AWS certifications and compliance frameworks"
              },
              "data_residency": {
                "type": "string",
                "description": "Data residency statement (e.g., UK (eu-west-2 London region))"
              },
              "encryption": {
                "type": "string",
                "description": "Encryption standards (at rest and in transit)"
              },
              "data_handling": {
                "type": "string",
                "description": "Data handling policy and practices"
              }
            }
          },
          "tco_projection": {
            "type": "object",
            "description": "3-year Total Cost of Ownership projection for Finance Evidence Pack (Story 4-4)",
            "required": ["year_1", "year_2", "year_3"],
            "properties": {
              "year_1": {
                "type": "object",
                "required": ["aws_services", "integration", "training", "support", "total"],
                "properties": {
                  "aws_services": {
                    "type": "number",
                    "description": "Year 1 AWS service costs (GBP)"
                  },
                  "integration": {
                    "type": "number",
                    "description": "Year 1 integration and development costs (GBP)"
                  },
                  "training": {
                    "type": "number",
                    "description": "Year 1 training costs (GBP)"
                  },
                  "support": {
                    "type": "number",
                    "description": "Year 1 support and maintenance costs (GBP)"
                  },
                  "total": {
                    "type": "number",
                    "description": "Year 1 total costs (GBP)"
                  }
                }
              },
              "year_2": {
                "type": "object",
                "required": ["aws_services", "integration", "training", "support", "total"],
                "properties": {
                  "aws_services": {
                    "type": "number",
                    "description": "Year 2 AWS service costs (GBP)"
                  },
                  "integration": {
                    "type": "number",
                    "description": "Year 2 integration costs (GBP)"
                  },
                  "training": {
                    "type": "number",
                    "description": "Year 2 training costs (GBP)"
                  },
                  "support": {
                    "type": "number",
                    "description": "Year 2 support costs (GBP)"
                  },
                  "total": {
                    "type": "number",
                    "description": "Year 2 total costs (GBP)"
                  }
                }
              },
              "year_3": {
                "type": "object",
                "required": ["aws_services", "integration", "training", "support", "total"],
                "properties": {
                  "aws_services": {
                    "type": "number",
                    "description": "Year 3 AWS service costs (GBP)"
                  },
                  "integration": {
                    "type": "number",
                    "description": "Year 3 integration costs (GBP)"
                  },
                  "training": {
                    "type": "number",
                    "description": "Year 3 training costs (GBP)"
                  },
                  "support": {
                    "type": "number",
                    "description": "Year 3 support costs (GBP)"
                  },
                  "total": {
                    "type": "number",
                    "description": "Year 3 total costs (GBP)"
                  }
                }
              }
            }
          },
          "aiFeatures": {
            "type": "array",
            "description": "AI features available in this scenario for explore page (Story 6.2)",
            "items": {
              "type": "object",
              "required": ["id", "name", "description", "category", "drupalPath", "status"],
              "properties": {
                "id": {
                  "type": "string",
                  "pattern": "^[a-z0-9-]+$",
                  "description": "Unique identifier for the feature"
                },
                "name": {
                  "type": "string",
                  "minLength": 3,
                  "maxLength": 50,
                  "description": "Display name for the feature"
                },
                "description": {
                  "type": "string",
                  "minLength": 20,
                  "maxLength": 200,
                  "description": "Brief description of what the feature does"
                },
                "icon": {
                  "type": "string",
                  "enum": ["edit", "simplify", "image", "speaker", "translate", "document", "council"],
                  "description": "Icon identifier for the feature card"
                },
                "category": {
                  "type": "string",
                  "enum": ["content", "accessibility", "generation"],
                  "description": "Feature category for grouping"
                },
                "categoryLabel": {
                  "type": "string",
                  "description": "Display label for the category"
                },
                "timeEstimate": {
                  "type": "string",
                  "description": "Estimated time to try this feature (e.g., '5 minutes')"
                },
                "drupalPath": {
                  "type": "string",
                  "description": "Drupal admin path for deep linking (e.g., '/admin/content')"
                },
                "awsService": {
                  "type": "string",
                  "description": "Primary AWS service powering this feature"
                },
                "status": {
                  "type": "string",
                  "enum": ["available", "requires-login", "coming-soon"],
                  "description": "Current availability status"
                },
                "statusLabel": {
                  "type": "string",
                  "description": "Display label for the status badge"
                },
                "order": {
                  "type": "integer",
                  "minimum": 1,
                  "description": "Display order within category"
                }
              }
            }
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
