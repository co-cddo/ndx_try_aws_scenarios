<?php

/**
 * @file
 * NDX AWS AI module.
 *
 * Provides AWS SDK integration for AI-powered features including:
 * - Amazon Bedrock (Nova 2 Pro/Lite/Omni models)
 * - Amazon Polly (Neural TTS)
 * - Amazon Translate (75+ languages)
 * - Amazon Rekognition (DetectLabels)
 * - Amazon Textract (AnalyzeDocument)
 *
 * Story 3.1: ndx_aws_ai Module Foundation
 */

declare(strict_types=1);

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function ndx_aws_ai_help(string $route_name, RouteMatchInterface $route_match): ?string {
  switch ($route_name) {
    case 'help.page.ndx_aws_ai':
      $output = '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('The NDX AWS AI module provides integration with AWS AI services for the NDX:Try demonstration platform.') . '</p>';
      $output .= '<h4>' . t('Supported Services') . '</h4>';
      $output .= '<ul>';
      $output .= '<li>' . t('<strong>Amazon Bedrock:</strong> AI content generation using Nova 2 models') . '</li>';
      $output .= '<li>' . t('<strong>Amazon Polly:</strong> Neural text-to-speech in 7 languages') . '</li>';
      $output .= '<li>' . t('<strong>Amazon Translate:</strong> Translation to 75+ languages') . '</li>';
      $output .= '<li>' . t('<strong>Amazon Rekognition:</strong> Automatic image labeling for alt text') . '</li>';
      $output .= '<li>' . t('<strong>Amazon Textract:</strong> PDF document text extraction') . '</li>';
      $output .= '</ul>';
      $output .= '<h4>' . t('Configuration') . '</h4>';
      $output .= '<p>' . t('Configure AWS settings at <a href=":url">Administration > Configuration > System > AWS AI Settings</a>.', [
        ':url' => '/admin/config/system/ndx-aws-ai',
      ]) . '</p>';
      return $output;

    case 'ndx_aws_ai.settings':
      return '<p>' . t('Configure AWS region and test connectivity. Credentials are automatically obtained from the ECS task IAM role.') . '</p>';

    default:
      return NULL;
  }
}

/**
 * Implements hook_theme().
 *
 * Story 4.6: Listen to Page (TTS Button)
 */
function ndx_aws_ai_theme(): array {
  return [
    'listen_to_page_player' => [
      'variables' => [
        'languages' => [],
        'default_language' => 'en-GB',
        'show_speed_control' => TRUE,
        'attributes' => [],
      ],
      'template' => 'listen-to-page-player',
    ],
  ];
}
