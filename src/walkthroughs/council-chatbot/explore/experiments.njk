---
layout: layouts/exploration
title: "What Can I Change? - Chatbot Experiments"
description: "5 guided experiments to test chatbot capabilities and learn its boundaries"
scenarioId: council-chatbot
eleventyNavigation:
  key: council-chatbot-experiments
  parent: council-chatbot-explore
  title: Experiments
---

{# Story 6.2: Council Chatbot Experiments Page #}

{% set scenarioId = "council-chatbot" %}
{% set explorationData = exploration[scenarioId] %}
{% set activities = explorationData.activities %}

{# Filter to just experiments #}
{% set experiments = [] %}
{% for activity in activities %}
  {% if activity.category == "experiments" %}
    {% set experiments = (experiments.push(activity), experiments) %}
  {% endif %}
{% endfor %}

{# Introduction #}
<section class="ndx-experiments-intro" aria-labelledby="intro-heading">
  <h2 class="govuk-heading-l" id="intro-heading">Test the Chatbot's Capabilities</h2>

  <p class="govuk-body-l">
    These 5 experiments will help you understand what the council chatbot can and can't do.
    Each one is <strong>safe to try</strong> - you won't break anything.
  </p>

  {# Sample Data Explanation Panel (Story 12.2) - AC1, AC2, AC3 #}
  {% include "components/sample-data-panel.njk" %}

  <div class="govuk-inset-text">
    <strong>Before you start:</strong> Make sure you have the
    <a href="/walkthroughs/{{ scenarioId }}/" class="govuk-link">chatbot deployed</a>
    and open in another tab. You'll copy questions from here and paste them into the chatbot.
  </div>

  {# Completion progress #}
  <div class="ndx-experiments-progress" data-progress-container>
    <p class="govuk-body">
      <strong>Your progress:</strong>
      <span data-completed-count>0</span> of {{ experiments | length }} experiments completed
    </p>
    <div class="ndx-progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="{{ experiments | length }}">
      <div class="ndx-progress-bar__fill" style="width: 0%"></div>
    </div>
  </div>
</section>

{# Stack status check #}
{% set stackExpired = false %}
{% include "components/exploration/fallback-banner.njk" %}

{# Experiments list #}
<section class="ndx-experiments-list" aria-labelledby="experiments-heading">
  <h2 class="govuk-visually-hidden" id="experiments-heading">All experiments</h2>

  {% for experiment in experiments %}
    {% set index = loop.index %}
    {% include "components/exploration/experiment-card.njk" %}
  {% endfor %}
</section>

{# What's Next #}
<section class="ndx-experiments-next" aria-labelledby="next-heading">
  <h2 class="govuk-heading-l" id="next-heading">What's Next?</h2>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-one-third">
      <div class="ndx-next-card">
        <h3 class="govuk-heading-s">How Does It Work?</h3>
        <p class="govuk-body-s">
          Explore the architecture behind the chatbot.
        </p>
        <a href="/walkthroughs/{{ scenarioId }}/explore/#architecture" class="govuk-link">
          Take the architecture tour
        </a>
      </div>
    </div>
    <div class="govuk-grid-column-one-third">
      <div class="ndx-next-card">
        <h3 class="govuk-heading-s">Test the Limits</h3>
        <p class="govuk-body-s">
          Push the boundaries safely.
        </p>
        <a href="/walkthroughs/{{ scenarioId }}/explore/#limits" class="govuk-link">
          Explore the limits
        </a>
      </div>
    </div>
    <div class="govuk-grid-column-one-third">
      <div class="ndx-next-card">
        <h3 class="govuk-heading-s">Generate Evidence</h3>
        <p class="govuk-body-s">
          Create a committee-ready report.
        </p>
        <a href="/evidence-pack/{{ scenarioId }}/" class="govuk-link">
          Create Evidence Pack
        </a>
      </div>
    </div>
  </div>
</section>

<style>
  .ndx-experiments-intro {
    margin-bottom: 40px;
  }

  .ndx-experiments-progress {
    background: #f8f8f8;
    padding: 20px;
    margin-top: 20px;
  }

  .ndx-progress-bar {
    height: 8px;
    background: #b1b4b6;
    border-radius: 4px;
    overflow: hidden;
    margin-top: 10px;
  }

  .ndx-progress-bar__fill {
    height: 100%;
    background: #00703c;
    transition: width 0.3s ease;
  }

  .ndx-experiments-list {
    margin-bottom: 60px;
  }

  .ndx-experiments-next {
    padding-top: 40px;
    border-top: 4px solid #1d70b8;
  }

  .ndx-next-card {
    padding: 20px;
    background: #f8f8f8;
    height: 100%;
  }

  .ndx-next-card h3 {
    margin-bottom: 10px;
  }

  .ndx-next-card p {
    margin-bottom: 10px;
  }

  @media (max-width: 768px) {
    .ndx-next-card {
      margin-bottom: 20px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Copy to clipboard functionality
    const copyButtons = document.querySelectorAll('.ndx-copy-button');

    copyButtons.forEach(button => {
      button.addEventListener('click', async function() {
        const text = this.dataset.copyText;
        const textSpan = this.querySelector('.ndx-copy-button__text');
        const successSpan = this.querySelector('.ndx-copy-button__success');

        try {
          await navigator.clipboard.writeText(text);
          textSpan.hidden = true;
          successSpan.hidden = false;

          // Reset after 2 seconds
          setTimeout(() => {
            textSpan.hidden = false;
            successSpan.hidden = true;
          }, 2000);

          // Announce to screen readers
          const announcement = document.createElement('div');
          announcement.setAttribute('role', 'status');
          announcement.setAttribute('aria-live', 'polite');
          announcement.className = 'govuk-visually-hidden';
          announcement.textContent = 'Text copied to clipboard';
          document.body.appendChild(announcement);
          setTimeout(() => announcement.remove(), 1000);

        } catch (err) {
          console.error('Copy failed:', err);
          // Fallback: select the text
          const code = this.previousElementSibling;
          if (code && window.getSelection) {
            const range = document.createRange();
            range.selectNodeContents(code);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
          }
        }
      });
    });

    // Start experiment function
    window.startExperiment = function(scenarioId, experimentId) {
      // Track analytics
      if (window.NDXAnalytics) {
        window.NDXAnalytics.trackExplorationActivityStarted(scenarioId, experimentId, 'experiments');
      }

      // Scroll to the chatbot embed or show instructions
      alert('Open the chatbot in another tab and paste the copied text. Then observe the response.');
    };

    // Reset conversation function
    window.resetConversation = function(scenarioId) {
      // This would typically call the deployed chatbot's reset endpoint
      alert('Conversation reset. You can start fresh with a new question.');
    };

    // Complete activity function
    window.completeActivity = function(scenarioId, activityId) {
      if (window.ExplorationState) {
        window.ExplorationState.markActivityCompleted(scenarioId, activityId);
        updateProgress();
      }

      if (window.NDXAnalytics) {
        window.NDXAnalytics.trackExplorationActivityCompleted(scenarioId, activityId);
      }

      // Visual feedback
      const card = document.querySelector(`[data-experiment-id="${activityId}"]`);
      if (card) {
        card.classList.add('ndx-experiment-card--completed');
      }
    };

    // Update progress display
    function updateProgress() {
      if (!window.ExplorationState) return;

      const scenarioId = '{{ scenarioId }}';
      const completed = window.ExplorationState.getCompletedCount(scenarioId);
      const total = {{ experiments | length }};

      const countEl = document.querySelector('[data-completed-count]');
      if (countEl) {
        countEl.textContent = completed;
      }

      const progressBar = document.querySelector('.ndx-progress-bar');
      const progressFill = document.querySelector('.ndx-progress-bar__fill');
      if (progressBar && progressFill) {
        const percentage = (completed / total) * 100;
        progressFill.style.width = percentage + '%';
        progressBar.setAttribute('aria-valuenow', completed);
      }
    }

    // Initialize progress on load
    updateProgress();
  });
</script>
