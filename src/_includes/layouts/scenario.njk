---
layout: page
---
{#
  Scenario Detail Page Layout

  This layout displays a single scenario with:
  - Full scenario metadata
  - Request session via NDX:Try guidance
  - Deployment status checking guidance
  - Cost transparency information
  - Error message guidance

  Expects front matter:
    title: string
    description: string
    scenario: string (scenario ID from scenarios.yaml)
#}

{% set scenarioData = scenarios.scenarios | findScenarioById(scenario) %}

{% if not scenarioData %}
  <div class="govuk-error-summary" data-module="govuk-error-summary">
    <h2 class="govuk-error-summary__title">Scenario not found</h2>
    <div class="govuk-error-summary__body">
      <p>The scenario "{{ scenario }}" could not be found.</p>
      <p><a href="/scenarios/" class="govuk-link">Browse all scenarios</a></p>
    </div>
  </div>
{% else %}

{# Phase Navigator - Story 12.1 #}
{% set scenarioId = scenario %}
{% include "components/phase-navigator.njk" %}

{# Breadcrumb navigation - Story 14.6 #}
{% set breadcrumbType = 'scenario' %}
{% include "components/breadcrumb.njk" %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    {# Badges #}
    <p class="govuk-body-s govuk-!-margin-bottom-2">
      {% if scenarioData.isMostPopular %}
        <span class="govuk-tag govuk-tag--yellow">Most Popular</span>
      {% endif %}
      {% if scenarioData.featured %}
        <span class="govuk-tag govuk-tag--purple{% if scenarioData.isMostPopular %} govuk-!-margin-left-1{% endif %}">Featured</span>
      {% endif %}
      <span class="govuk-tag govuk-tag--{{ scenarioData.difficulty | difficultyColor }}{% if scenarioData.isMostPopular or scenarioData.featured %} govuk-!-margin-left-1{% endif %}">
        {{ scenarioData.difficulty | capitalize }}
      </span>
    </p>

    {# Headline #}
    <p class="govuk-body-l">{{ scenarioData.headline }}</p>

    {# Description #}
    <p class="govuk-body">{{ scenarioData.description }}</p>

    {# What you'll learn #}
    <h2 class="govuk-heading-m">What you'll learn</h2>
    <ul class="govuk-list govuk-list--bullet">
      {% for skill in scenarioData.skillsLearned %}
        <li>{{ skill }}</li>
      {% endfor %}
    </ul>

    {# Business outcomes #}
    {% if scenarioData.businessOutcomes %}
      <h2 class="govuk-heading-m">Business outcomes</h2>
      <ul class="govuk-list govuk-list--bullet">
        {% for outcome in scenarioData.businessOutcomes %}
          <li>{{ outcome }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    {# AWS Services Used #}
    <h2 class="govuk-heading-m">AWS services used</h2>
    <p class="govuk-body">
      {% for service in scenarioData.awsServices %}
        <span class="govuk-tag govuk-tag--blue govuk-!-margin-right-1 govuk-!-margin-bottom-1">{{ service }}</span>
      {% endfor %}
    </p>
  </div>

  <div class="govuk-grid-column-one-third">
    {# Scenario summary card #}
    <div class="ndx-scenario-summary">
      <h2 class="govuk-heading-s">At a glance</h2>
      <dl class="govuk-summary-list govuk-summary-list--no-border">
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Time</dt>
          <dd class="govuk-summary-list__value">{{ scenarioData.timeEstimate }}</dd>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Cost</dt>
          <dd class="govuk-summary-list__value">
            <strong class="govuk-tag govuk-tag--green">FREE via NDX:Try</strong>
          </dd>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Audience</dt>
          <dd class="govuk-summary-list__value">
            <strong class="govuk-tag govuk-tag--{{ scenarioData.primaryPersona | personaColor }}">
              {{ scenarioData.primaryPersona | capitalize | replace("-", " ") }}
            </strong>
          </dd>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">Security</dt>
          <dd class="govuk-summary-list__value">
            <span class="govuk-tag govuk-tag--green">Sandbox isolated</span>
          </dd>
        </div>
      </dl>
    </div>
  </div>
</div>

{# Walkthrough CTA - Story 15.1 #}
{# Positioned after description, before deployment section #}
<div class="govuk-grid-row govuk-!-margin-top-4">
  <div class="govuk-grid-column-two-thirds">
    <h2 class="govuk-heading-m">Try the walkthrough</h2>
    <p class="govuk-body">Experience this scenario step-by-step with our guided walkthrough. No deployment required - see the actual screens and functionality.</p>
    {% include "components/walkthrough-cta.njk" %}
  </div>
</div>

{# Screenshot Walkthrough Section - Zero-Deployment Path (Story 2.5 - AC-2.5.1) #}
{# Positioned after video section, before deployment section #}
{% include "components/screenshot-walkthrough.njk" %}

{# Request Session via NDX:Try Section #}
<div class="govuk-!-margin-top-8">
  <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">

  <h2 class="govuk-heading-l">Request a session via NDX:Try</h2>

  {% if scenarioData.deployment %}
    {# Free Trial Banner - NDX:Try AWS Partnership #}
    {% include "components/free-trial-banner.njk" %}

    <p class="govuk-body">To try this scenario, request a session through the NDX:Try portal. Sessions are free for UK public sector organisations.</p>

    {# How it works #}
    <div class="govuk-!-margin-bottom-6">
      <h3 class="govuk-heading-s">How it works</h3>
      <ol class="govuk-list govuk-list--number">
        <li><strong>Request a session</strong> - Visit the NDX:Try catalogue and request this scenario</li>
        <li><strong>Accept the terms</strong> - Review and accept the Acceptable Use Policy</li>
        <li><strong>Wait for deployment</strong> - Your session will be provisioned automatically ({{ scenarioData.deployment.deploymentTime | default('5-15 minutes') }})</li>
        <li><strong>Access your AWS account</strong> - Sign in via IAM Identity Center when your session is active</li>
      </ol>
    </div>

    {# Request Session Button #}
    <div class="ndx-request-action">
      <a href="https://ndx.digital.cabinet-office.gov.uk/catalogue/tags/try-before-you-buy/"
         role="button"
         draggable="false"
         class="govuk-button govuk-button--start"
         data-module="govuk-button">
        Request session on NDX:Try
        <svg class="govuk-button__start-icon" xmlns="http://www.w3.org/2000/svg" width="17.5" height="19" viewBox="0 0 33 40" aria-hidden="true" focusable="false">
          <path fill="currentColor" d="M0 0h13l20 20-20 20H0l20-20z"/>
        </svg>
      </a>
      <p class="govuk-body-s govuk-!-margin-top-2">
        Opens the NDX:Try catalogue (requires login)
      </p>
    </div>

  {% else %}
    {# No deployment configured - show placeholder #}
    <div class="govuk-inset-text">
      <p>This scenario is being prepared for NDX:Try.</p>
      <p><a href="/contact/" class="govuk-link">Contact us</a> if you'd like to be notified when it's ready.</p>
    </div>
  {% endif %}
</div>

{# Deployment Status - Check your session status #}
{% include "components/deployment-progress.njk" %}

{# After Session Starts - What to do when active #}
{% include "components/deployment-success.njk" %}

{# Credentials Card - Easy access to credentials (Story 2.3) #}
{# Only show for LocalGov Drupal as it has Drupal-specific credential fields #}
{% if scenarioData.id == 'localgov-drupal' %}
{% include "components/credentials-card.njk" %}
{% endif %}

{# Error Messages Reference #}
<div class="govuk-!-margin-top-8">
  <details class="govuk-details">
    <summary class="govuk-details__summary">
      <span class="govuk-details__summary-text">Troubleshooting common deployment issues</span>
    </summary>
    <div class="govuk-details__text">
      {% include "components/error-messages.njk" %}
    </div>
  </details>
</div>

{# Related Scenarios - Cross-linking #}
{% set relatedScenarios = scenarioData | getRelatedScenarios(scenarios.scenarios) %}
{% if relatedScenarios.length > 0 %}
<div class="govuk-!-margin-top-6">
  <h2 class="govuk-heading-m">Related scenarios to explore</h2>
  <p class="govuk-body">These scenarios use similar AWS services or address related local government needs:</p>
  <div class="govuk-grid-row">
    {% for related in relatedScenarios %}
    <div class="govuk-grid-column-one-half govuk-!-margin-bottom-4">
      <div class="ndx-related-card">
        <h3 class="govuk-heading-s govuk-!-margin-bottom-1">
          <a href="{{ related.url }}" class="govuk-link">{{ related.name }}</a>
        </h3>
        <p class="govuk-body-s govuk-!-margin-bottom-2">{{ related.headline }}</p>
        <p class="govuk-body-s govuk-!-margin-bottom-0">
          <strong class="govuk-tag govuk-tag--green govuk-!-margin-right-1">FREE</strong>
          <span class="govuk-tag govuk-tag--{{ related.difficulty | difficultyColor }}">{{ related.difficulty | capitalize }}</span>
        </p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

{# Related Links #}
<div class="govuk-!-margin-top-6">
  <h2 class="govuk-heading-m">Other resources</h2>
  <ul class="govuk-list">
    <li><a href="/scenarios/" class="govuk-link">Browse all scenarios</a></li>
    <li><a href="/quiz/" class="govuk-link">Find your scenario (quiz)</a></li>
    <li><a href="/get-started/" class="govuk-link">Get started guide</a></li>
  </ul>
</div>

{% endif %}

<script src="/assets/js/phase-state.js" defer></script>
<script src="/assets/js/credentials-card.js" defer></script>
