{#
  Next Steps Card Component (Story 6.5)

  Displays next steps for a specific persona with:
  - Persona name and icon
  - Description of the persona
  - List of actionable steps with links

  Expects: persona object from extend data

  Usage:
    {% for persona in extend.personas %}
      {% include "components/next-steps-card.njk" %}
    {% endfor %}

  Accessibility:
    - Links use proper external link patterns
    - Icons are decorative (aria-hidden)
    - Semantic heading structure
#}

<article class="ndx-next-steps-card" data-persona="{{ persona.id }}">
  <header class="ndx-next-steps-card__header">
    <div class="ndx-next-steps-card__icon" aria-hidden="true">
      {% if persona.icon == "edit" %}
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
      {% elif persona.icon == "code" %}
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="16 18 22 12 16 6"/>
          <polyline points="8 6 2 12 8 18"/>
        </svg>
      {% elif persona.icon == "document" %}
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
        </svg>
      {% else %}
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
          <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
      {% endif %}
    </div>

    <div class="ndx-next-steps-card__title-area">
      <h3 class="govuk-heading-m ndx-next-steps-card__title">{{ persona.name }}</h3>
      <p class="govuk-body-s ndx-next-steps-card__description">{{ persona.description }}</p>
    </div>
  </header>

  <ul class="govuk-list ndx-next-steps-card__list">
    {% for step in persona.nextSteps %}
      <li class="ndx-next-steps-card__step">
        {% if step.external %}
          <a href="{{ step.url }}" class="govuk-link ndx-next-steps-card__link" target="_blank" rel="noopener noreferrer">
            <strong class="ndx-next-steps-card__step-title">{{ step.title }}</strong>
            <svg class="ndx-external-icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
              <polyline points="15 3 21 3 21 9"/>
              <line x1="10" y1="14" x2="21" y2="3"/>
            </svg>
            <span class="govuk-visually-hidden">(opens in new tab)</span>
          </a>
        {% else %}
          <a href="{{ step.url }}" class="govuk-link ndx-next-steps-card__link">
            <strong class="ndx-next-steps-card__step-title">{{ step.title }}</strong>
          </a>
        {% endif %}
        <span class="ndx-next-steps-card__step-desc">{{ step.description }}</span>
      </li>
    {% endfor %}
  </ul>
</article>

<style>
  .ndx-next-steps-card {
    background: #fff;
    border: 1px solid #b1b4b6;
    padding: 25px;
    height: 100%;
  }

  .ndx-next-steps-card__header {
    display: flex;
    gap: 15px;
    align-items: flex-start;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f3f2f1;
  }

  .ndx-next-steps-card__icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f3f2f1;
    border-radius: 8px;
    color: #1d70b8;
    flex-shrink: 0;
  }

  .ndx-next-steps-card__title-area {
    flex: 1;
  }

  .ndx-next-steps-card__title {
    margin-top: 0;
    margin-bottom: 5px;
  }

  .ndx-next-steps-card__description {
    color: #505a5f;
    margin-bottom: 0;
  }

  .ndx-next-steps-card__list {
    margin-bottom: 0;
  }

  .ndx-next-steps-card__step {
    padding: 12px 0;
    border-bottom: 1px solid #f3f2f1;
  }

  .ndx-next-steps-card__step:last-child {
    border-bottom: none;
    padding-bottom: 0;
  }

  .ndx-next-steps-card__link {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    text-decoration: none;
  }

  .ndx-next-steps-card__link:hover .ndx-next-steps-card__step-title {
    text-decoration: underline;
  }

  .ndx-next-steps-card__step-title {
    display: inline;
  }

  .ndx-next-steps-card__step-desc {
    display: block;
    margin-top: 4px;
    color: #505a5f;
    font-size: 14px;
  }

  .ndx-external-icon {
    flex-shrink: 0;
    opacity: 0.7;
  }

  @media (max-width: 640px) {
    .ndx-next-steps-card__header {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
  }
</style>
